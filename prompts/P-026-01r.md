# Follow-up for P-026 — finish remaining Payment UX and Add Payment cascade

## Do not modify CI/Actions.

## A) Sticky footer & Back placement
- Render the **Back** control inside the sticky footer bar (same container as primary actions).
- Ensure dialog body is the scroll container; add bottom padding = footer height.

## B) Remaining blink — single render
- **Payment Amount**: never blinks.
- **Remaining**: render once with the blink class; remove duplicate spans/elements.

## C) Session assignment — always visible & functional
- Keep the assignment table visible even when computed rows are 0 (show a zero-state).
- Selecting/unselecting updates Remaining immediately and persists via existing hooks/services.

## D) Add Payment dialog — full cascade & writes
- **Payment Method** dropdown: `FPS`, `Bank Transfer`, `Cheque` → write `method: string`.
- **Entity** dropdown: `Music Establish (by ERL)`, `Personal` → write `entity`.
- If **Entity = Music Establish (by ERL)**:
  - **Bank** dropdown: list ERL directory banks (display `{bank name} {bankCode}`; fallback `{docId} {collectionId}`).
  - **Bank Account** dropdown: list sub-collection accounts for the bank (label = `accountType`).
  - On submit, set **`identifier = "{bankCode}/{accountDocId}"`**.
- **Reference Number** text input → `refNumber: string`.
- Rename **Save** → **Submit**.
- On submit also stamp **`timestamp`** and **`editedBy`**.
- Reuse normalization: if manually typed `identifier` doesn’t match `/^[0-9A-Za-z]+\/[0-9A-Za-z_-]+$/`, recompute from bank+account.

## E) Payment History (list) — “For Session(s)” truncation
- Add/restore the column and display at most **5** ordinals; if more, show trailing `…` after the 5th.

## F) Header width decouple
- Ensure long headers don’t block narrow columns (e.g., `table-layout: fixed` + `th` ellipsis; keep resizable cell widths).

## Tests
- Unit: any helpers you add (session truncation, identifier build) must have basic tests.
- Cypress/component:
  - Only Remaining blinks; Payment Amount never blinks.
  - Assignment table shows zero-state and updates Remaining on selection.
  - Add Payment cascade writes `method`, `entity`, `identifier`, `refNumber`, `timestamp`, `editedBy`.
  - Payment History list shows “For Session(s)” with ≤5 ordinals + `…`.

## Acceptance
- Back inside sticky footer; footer sticks to window edge.
- Remaining blink fixed to single render.
- Assignment table stable and functional.
- Add Payment cascade implemented with identifier and audit fields.
- List “For Session(s)” shows 5-then-ellipsis.
- No new TS errors.

## Save this prompt
Create exactly `prompts/P-026-01r.md` with this content.
