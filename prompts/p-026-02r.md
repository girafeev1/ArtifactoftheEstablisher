P-026-02r — Finalize Payment UX + Add Payment cascade

## Rules
- Do NOT modify CI/workflows. (Deploy gating handled separately.)
- Keep changes minimal, typed, and within existing components.

## A) Sticky footer + Back placement
- Render the Back control INSIDE the dialog’s sticky footer/action bar (same region as primary actions).
- Ensure the dialog BODY is the scroll container; add bottom padding equal to the footer height so content isn’t hidden.
- Footer CSS (adapt to stack):
  position: sticky; bottom: 0; z-index: 10;
  border-top: 1px solid var(--mui-palette-divider);
  box-shadow: 0 -2px 8px rgba(0,0,0,.04);
  background: inherit;

## B) Remaining blink — single render only
- Payment Amount: never blinks.
- Remaining: render ONCE with the blink class. Remove any duplicate span/element causing double or flicker.

## C) Session assignment list — always visible & functional
- Keep the assignment section visible even when computed rows are 0 (show a zero-state).
- Selecting/unselecting sessions updates Remaining immediately and persists via existing hooks/services.
- The “For Session(s)” summary (detail view) MUST NOT hide or replace the assignment controls.

## D) Add Payment dialog — cascade + writes
Implement the full cascade as previously specified:

1) Payment Method dropdown: FPS, Bank Transfer, Cheque → write method: string.
2) Entity dropdown: Music Establish (by ERL), Personal → write entity.
3) If Entity = Music Establish (by ERL):
   - Bank dropdown: list ERL directory banks; label each as {bankName} {bankCode} (fallback {docId} {collectionId} if needed).
   - Bank Account dropdown: for the chosen bank, list sub-collection accounts; label with each account’s accountType.
   - On submit, set identifier = "{bankCode}/{accountDocId}".
4) Reference Number input → write refNumber: string.
5) Rename Save → Submit.
6) On submit also stamp timestamp and editedBy.
7) Normalization: if user-entered identifier does not match /^[0-9A-Za-z]+\/[0-9A-Za-z_-]+$/, recompute from {bankCode}/{accountDocId}.

## E) Payment History (list view) — “For Session(s)” column
- Ensure the column exists in the list view and displays up to 5 session ordinals; if more, append a trailing … after the 5th.
- Keep cell/headers ellipsized; no header should block narrowing.

## F) Header width decouple
- Make sure long headers don’t prevent narrow columns:
  - table-layout: fixed where appropriate
  - th, .table-header with overflow: hidden; text-overflow: ellipsis; white-space: nowrap
  - Retain resizable data cell widths.

## Tests
- Unit: helpers for session truncation and identifier build/normalize.
- Cypress / component:
  - Only Remaining blinks; Payment Amount static.
  - Assignment table shows zero-state and updates Remaining on selection.
  - Add Payment cascade: pick Entity=ERL → Bank → Bank Account → Submit; verify method, entity, identifier, refNumber, timestamp, editedBy.
  - Payment History (list): For Session(s) shows ≤5 ordinals with trailing ….

> CI may skip Cypress due to headless deps; keep specs committed and guard with conditional skip if needed. Do NOT edit workflows.

## Acceptance
- Back sits in sticky footer; footer sticks to window edge.
- Remaining blink uses a single element; no flicker/double.
- Assignment section remains visible and functional.
- Add Payment cascade fully implemented; identifier & audit fields written.
- List “For Session(s)” shows 5-then-ellipsis.
- No new TypeScript errors.

## Save this prompt
Create prompts/p-026-02r.md with this content.
## Branch & PR
- Branch: codex/finalize-payment-ux-and-functionality-enhancements-02r
- PR title: feat(payment): finalize sticky footer, remaining blink, assignment, Add Payment cascade, list truncation (P-026-02r)
- Labels: payments, ui, codex
